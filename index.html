<!doctype html>
<html>
  <head>
    <title>Sprint Orienteering</title>
    <script src="./Code/jquery.min.js"></script>
    <script src="./Code/jspsych.js"></script>
    <script src="./Code/plugins/jspsych-text.js"></script>
    <script src="./Code/plugins/jspsych-single-stim.js"></script>
    <script src="./Code/plugins/jspsych-survey-multi-choice.js"></script>
    <script src="./Code/plugins/jspsych-button-response.js"></script>
    <link href="./Code/css/jspsych.css" rel="stylesheet" type="text/css"></link>
  </head>

 <body>


    <!-- ####################### Heading ####################### -->
	<a name="top"></a>
	<h1 style="text-align:center; width:1200px" id="header" class="header">&nbsp; Cognitive Science in Orienteering</h1>


    <!-- ####################### Start page ####################### -->

	<div class="start" style="width: 1000px">
		<!-- Text box for the splash page -->
		<div class="start" style="text-align:left; border:0px solid; padding:10px;  width:800px; float:right; font-size:90%">
			<p><b>"Reading Sprint Maps"</b> is a short psychological study investigating how people read sprint orienteering maps. It involves
                the following steps:</p>
			<ol>
				<li> We ask for demographic information.<br></li>
				<li> We ask for your consent. <br></li>
				<li> The study then explains how to do the task in detail. You will need to pass a short test to
                     check that you understand how the study works.<br></li>
				<li> Next comes the experiment itself.<br></li>
				<li> At the end, we'll show you a summary of your results and give you the option to identify yourself so we can email you a summary</li>
			</ol>
			<p>
                The total time taken should be about 10 minutes. Please <u>don't</u> use the "back" button on
                your browser or close the window until you reach the end.  Doing this is very likely to break the experiment and may make it difficult for you to get a copy of your results.
                But, if something does go wrong, please contact us, and we will do what we can to fix it! When you're ready to begin, click
                on the "start" button below.</p>

		<!-- Next button for the splash page -->
               <p align="center"> <input type="button" id="splashButton" class="start jspsych-btn" value="Start!"
                       onclick="splashButtonClick()"> </p>

            </div>
	</div>

	<!-- ####################### Consent ####################### -->
	<div class="consent" style="display:none; width:1000px">
		<!-- Text box for the splash page -->
		<div class="consent" style="text-align:left; border:0px solid; padding:10px;  width:800px; font-size:90%; float:right">

			<p align="right">-</p>

			<p align="center"><b>PARTICIPANT INFORMATION STATEMENT</b><br><br>
			Understanding How Sprint Orienteers Make Decisions
			</p>

			<p><b>Purpose of study</b></p>
			<p>We hope to learn the processes behind route decision making in a sprint orienteering environment.  This information will be used to develop training to enhance sprint orienteering performance.</p>

			<p><b>Participant selection</b></p>
			<p>Participants in this study are drawn from the orienteering community.  Participation in this study may be recommended as part of a training program to assist with learning the skill of map reading.</p>

			<p><b>Confidentiality and Disclosure of Information</b></p>
			<p>This software does not require you to identify yourself unless you choose to do so.  For participants who do identify themselves, information on their test results and that of average participants will be made available to them on request.
All information gathered by this study will be stored securely, information identifying individual participants will be destroyed after 2 years.
If you give us your permission by clicking on the “I agree” button below, we plan to publish the results in academic journals and discuss the results at scientific conferences. In any publication, information will be provided in such a way that you cannot be identified.</p>

			<p><b>Description of study and risks</b></p>
			<p>No discomforts or inconveniences besides some boredom or possibly a desire to cast aside electronic devices and go running are reasonably expected. No risks are reasonably expected as a result of your participation in this study. We cannot and do not guarantee or promise that you will receive any benefits from this study.</p>

			<p><b>Your consent</b></p>
			<p>If you decide to participate, you are free to withdraw your consent and to discontinue participation
at any time.</p>

			<p><b>Inquiries</b></p>
			<p>If you have any questions or concerns following your participation, Ian Davies (+61 4 0006 0971, email. daviesi@student.unimelb.edu.au) will be happy to address them.<p>

			<p>Please keep a copy of this information sheet (you can download the pdf <a href="./Resources/info.pdf" target="_blank">here</a>)</p>

			<br>
			<p align="center"><b>PARTICIPANT CONSENT</b></p>

			By continuing, you are making a decision whether or not to participate.  Clicking the button below indicates that, having read the information provided on the participant information sheet, you have decided to participate.

			<br>
			<p align="center">
                <input type="button" id="consentButton" class="consent jspsych-btn" value="I agree" onclick="consentButtonClick()" >
			</p>


			<p>To withdraw your consent, simply close the browser tab and return the HIT. Your data will be deleted from our records.</p>
		</div>
        <br><br>
	</div>


	<!-- ####################### Demographics ####################### -->

	<div class="demographics" style="display:none; align:center; width: 1000px">
		<div class="demographics" style="text-align:left; border:0px solid; padding:10px;  width:800px; font-size:90%; float:right">
			<!-- Explanatory text -->
            <p font-size:110%><b>Demographic information:</b></p>
			<p>
                We need this information to assist with our analysis, so please be honest with your answers.  It cannot be used to identify you, we give you the option of giving us that information later.      </p><br>

			<!-- Gender -->
	 		<label for="gender"><b>Gender: &nbsp;</b></label>
	  		<input type="radio" name="gender" value="male" /> Male &nbsp;
	  		<input type="radio" name="gender" value="female" /> Female &nbsp;
	  		<input type="radio" name="gender" value="other" /> Other<br /><br />

			<!-- Age -->
	  		<label for="age"><b>Age: &nbsp;</b></label>
			<select name="age" id="age" class='drop-menu'>
		<option>5 or younger</option>
                <option>6</option>
                <option>7</option>
                <option>8</option>
                <option>9</option>
                <option>10</option>
                <option>11</option>
	    	<option>12</option>
                <option>13</option>
                <option>14</option>
	    	<option>15</option>
                <option>16</option>
                <option>17</option>
                <option>18</option>
                <option>19</option>
                <option selected="selected">20</option>
                <option>21</option>
	    	<option>22</option>
                <option>23</option>
                <option>24</option>
		<option>25</option>
                <option>26</option>
                <option>27</option>
                <option>28</option>
                <option>29</option>
                <option>30</option>
                <option>30 to 35</option>
	    	<option>35 to 40</option>
                <option>40 to 45</option>
                <option>45 to 50</option>
		<option>50 to 55</option>
	    	<option>55 to 60</option>
                <option>60 to 65</option>
                <option>65 to 70</option>
		<option>70 to 80</option>
                <option>80 to 90</option>
                <option>90+ (congratulations!)</option>
		</select><br /><br />

			<!-- Language -->
	  		<label for="language"><b>Native Language(s): &nbsp;</b></label>
            <input id="language" name="language" /><br /><br />

			<!-- Experience -->
	  		<label for="experience"><b>Experience level: &nbsp;</b></label>
	  		<input type="radio" name="experience" value="never " /> I have never run a Sprint event&nbsp;
	  		<input type="radio" name="experience" value="expn" /> Some experience &nbsp;<br />
	  		<input type="radio" name="experience" value="elite" /> I run M20E, M21E, W20E, or W21E&nbsp;
			<input type="radio" name="experience" value="past-elite" /> I used to run Elete<br /><br />

			<!-- Handedness -->
	  		<label for="handedness"><b>Are you Left or Right handed?: &nbsp;</b></label>
	  		<input type="radio" name="experience" value="never " /> Left handed&nbsp;
	  		<input type="radio" name="experience" value="expn" /> Right handed &nbsp;<br />
	  		<br />

			<!-- Language -->
	  		<label for="language"><b>Native Language(s): &nbsp;</b></label>
            <input id="language" name="language" /><br /><br />

			<!-- Country -->
			<label for="country"><b>Country you live in: &nbsp;</b></label>
	  		<select name="country" id="country" class='drop-menu'>
	    	<option>Antarctica</option>
                <option selected="selected">Australia</option>
                <option>Denmark</option>
              	<option>Finland</option>
                <option>France</option>
                <option>New Zealand</option>
                <option>Qatar</option>
               	<option>Sweden</option>
                <option>Switzerland</option>
                <option>United Kingdom</option>
                <option>United States of America</option>
                </select>

			<br>
		<br>

		<!-- Demographics  button -->
        <p align="center">
                <input type="button" class="demographics jspsych-btn" id="demographicsButton" value="Next >"
                       onclick="demographicsButtonClick()">
       </p>
	</div>


  </body>

  <script>




	  /* initialise */
      var timeline=[];
      var introloop=[];
	  var testorder = jsPsych.randomization.shuffle([2, 3, 4, 5, 6, 7, 8]); // omit test item 1 in this version!
	  var condition = jsPsych.randomization.shuffle(["category","property"])[0];
      var baserate = jsPsych.randomization.shuffle(["small","large"])[0];
      var turkcode = (Math.floor(Math.random() * 899999) + 100000).toString(); // generate completion code



        // ----------------------- legacy stuff ------------------

        // move to the specified location
        function scrollTo(hash) {
            location.hash = "#" + hash;
        }

        // get the value of a radio button
        function getRadioButton(name) {
            var i, radios = document.getElementsByName(name);
            for (i = 0; i < radios.length; i = i + 1) {
                if (radios[i].checked) {
                    return (radios[i].value);
                }
            }
            return("NA")
        }

        // function to change the display property of a set of objects
        function setDisplay(theClass, theValue) {
            var i, classElements = document.getElementsByClassName(theClass);
            for (i = 0; i < classElements.length; i = i + 1) {
                classElements[i].style.display = theValue;
            }
        }

        // function to change the visibility property of a set of objects
        function setVisibility(theClass, theValue) {
            var i, classElements = document.getElementsByClassName(theClass);
            for (i = 0; i < classElements.length; i = i + 1) {
                classElements[i].style.visibility = theValue;
            }
        }

        // set the focus
        function setFocus(theElement) {
            document.getElementById(theElement).focus();
        }

        // alter the header
        function setHeader(theValue) {
            document.getElementById("header").innerText = theValue;
        }

        // alter the border (on one of the instruction boxes)
        function setBoxBorder(whichBox, theValue) {
            document.getElementById('instruction' + whichBox + 'inner').style.border = theValue;
        }

        // clear all the check marks for the radio buttons
        function clearCheckRadio() {
            var i, radios = document.getElementsByClassName('checkRadio');
            for (i = 0; i < radios.length; i = i + 1) {
                radios[i].checked = false;
            }
        }

        // ------------- handle the introductory stuff ----------------

        function splashButtonClick() {
            setDisplay('start', 'none');
            setDisplay('consent', '');
            setHeader(' ');
        }

        function consentButtonClick() {
            setDisplay('consent', 'none');
            setDisplay('demographics', '');
            setHeader(' ');
        }

      /* save and finish */
      function endExperiment(dataset,callback) {

          // $.post('submit',{"content": dataset});
          setTimeout(callback,1000)

      }


      /* start the experiment */
      function startExperiment(){

          //document.getElementById("splash").style.display = "none";
          jsPsych.init({
            timeline: timeline,
            preload_images: images,
            on_finish: function() {
                endExperiment( jsPsych.data.dataAsCSV(), function() {
                                        document.write('<div id="endscreen" class="endscreen" style="width:1000px"><div class="endscreen" style="text-align:center; border:0px solid; padding:10px; font-size:120%; width:800px; float:right"><p><br><br><br>All done!<br><br>Your completion code is <span id="turkcode" style="font-weight:bold;font-size:130%">' + turkcode + '</span>. To receive payment for the HIT, return to the Amazon Mechanical Turk page and enter this code. Please contact us if something goes wrong and we\'ll fix it as quickly as possible.</p></div></div>')
                    }
                )
            }
          });
      }

        function demographicsButtonClick() {
            setDisplay('demographics', 'none');
            setDisplay('header','none')
            //setHeader('');

            //data.other.gender = getRadioButton("gender");
            //data.other.age = document.getElementById("age").value;
            //data.other.language = document.getElementById("language").value;
            //data.other.country = document.getElementById("country").value;

            // record the condition assignment in the jsPsych data
            jsPsych.data.addProperties({
                gender: getRadioButton("gender"),
                age: document.getElementById("age").value,
                language: document.getElementById("language").value,
                country: document.getElementById("country").value,
                experience: getRadioButton("experience").value,
                handedness: getRadioButton("handedness").value
            });


            // record the condition assignment in the jsPsych data
            jsPsych.data.addProperties({
                sampling: condition,
                baserate: baserate,
                turkcode: turkcode
            });

            startExperiment();
        }


      // -------------------- main expt ----------------


	  /* function that generates test string */
	  function testString(ind) {
		  var str;
		  str = "<img src='./img/test" + ind + ".jpg' width=800px><p width=800px><span id='qqqqq' style='display:none'>In your opinion, how likely is it that a Sodor sphere of this size has a plaxium coating?</span></p>"
	  	return(str)
	  }


      /* define setup block */
      var setup_block = {
          type: 'button-response',
          timing_post_trial: 0,
	      button_html: '<button class="jspsych-btn" style="display:none">%choice%</button>',
          choices: ['Click here to continue'],
          on_trial_start: function() { setTimeout(function() {setDisplay("jspsych-btn","")}, 1500)},
          is_html: true,
          timeline: [
              {stimulus: '<img src="./Data/Intro1.jpg" width=800px>'},
	      {stimulus: '<img src="./Data/robot2.jpg" width=800px>'},
              {stimulus: '<img src="./Data/robot3.jpg" width=800px>'},
              {stimulus: '<img src="./Data/robot6.jpg" width=800px>'},
              {stimulus: '<img src="./img/robot7.jpg" width=800px>'},
              {stimulus: '<img src="./img/robot8_' + condition + '.jpg" width=800px>'},
              {stimulus: '<img src="./img/robot9_' + condition + '.jpg" width=800px>'},
              {stimulus: '<img src="./img/robot10_' + condition + '.jpg" width=800px>'}
          ]
      };
      introloop.push(setup_block);




      /* define instruction check block */
      var instructioncorrect = false;
      var q3a;
      if(condition == "category") {
          q3a = [" Yes, it checks every sphere it encounters"," No, it only tests the small spheres"];
      } else {
          q3a = [" Yes, it checks every sphere it encounters"," No, it only tests spheres with the plaxium coating"];
      }

	  var instruction_check = {
          type: "survey-multi-choice",
          preamble: ["<p align='center'><b>Check your knowledge before you begin!</b></p>"],
          questions: ["<b>Question 1</b>: What is your goal in this task?", "<b>Question 2</b>: Which is true about the size of Sodor spheres?","<b>Question 3</b>: Does the probe transmit data about any sphere it encounters?"],
          randomize_order: true,
          options: [[" To find out if the planet Sodor is made of cheese"," To find out which Sodor spheres have plaxium coatings"],jsPsych.randomization.shuffle(["Spheres on Sodor come in a variety of sizes", "Spheres on Sodor are always small", "Spheres on Sodor are always large"]),q3a],
          on_finish: function(data) {

              if(condition == "category") {
                if( data.responses == '{"Q0":" To find out which Sodor spheres have plaxium coatings","Q1":"Spheres on Sodor come in a variety of sizes","Q2":" No, it only tests the small spheres"}') {
                  action = false;
                  instructioncorrect = true;
                }
              }

              if(condition == "property") {
                if( data.responses == '{"Q0":" To find out which Sodor spheres have plaxium coatings","Q1":"Spheres on Sodor come in a variety of sizes","Q2":" No, it only tests spheres with the plaxium coating"}') {
                  action = false;
                  instructioncorrect = true;
                }
              }

              //console.log(hack)
          }
      }
      introloop.push(instruction_check)

      var showsplash = true;
      var splash_screen = {
          type: 'button-response',
          timing_post_trial: 0,
	      button_html: '<button class="jspsych-btn" style="display:none">%choice%</button>',
          choices: ['Click here to read the instructions again'],
          on_trial_start: function() { setTimeout(function() {setDisplay("jspsych-btn","")}, 1000)},
          is_html: true,
          stimulus: '<img src = "./img/instructionfail.jpg" width=800px>'
      }

      var conditional_splash = {
          timeline: [splash_screen],
          conditional_function: function(data) {
              return !instructioncorrect // skip if correct
          }
      }
      introloop.push(conditional_splash)

      var loop_node = {
          timeline: introloop,
          loop_function: function(data) {
              //var action = true;
              return !instructioncorrect // stop looping if correct


          }
      }
      timeline.push(loop_node)


      /* success trial */
      var successtrial = {
          type: 'button-response',
          timing_post_trial: 0,
	      button_html: '<button class="jspsych-btn" style="display:none">%choice%</button>',
          choices: ['Click here to begin the mission'],
          on_trial_start: function() { setTimeout(function() {setDisplay("jspsych-btn","")}, 1000)},
          is_html: true,
          timeline: [
              {stimulus: '<img src = "./img/instructionsuccess_' + condition + '.jpg" width=800px>'},
              {stimulus: '<img src = "./img/dataX_' + condition + '.jpg" width=800px>'}
            ]
      };
      timeline.push(successtrial);

      // function to change the display property of a set of objects
      function setDisplay(theClass, theValue) {
	       var i, classElements = document.getElementsByClassName(theClass);
	       for (i = 0; i < classElements.length; i = i + 1) {
		      classElements[i].style.display = theValue;
	       }
      }


	  /* define observation trial */
      var arrivalprompt;
      if(condition == "property") {
          arrivalprompt = "The probe has detected a sphere with plaxium: Click here to view";
      } else {
          arrivalprompt = "The probe has found and tested a small sphere: Click here to view";
      }
      var waitprompt = "<p align='center' style='color:white'>...</p>";

      var obs_block1 = {
          type: 'button-response',
          timing_post_trial: 0,
	      button_html: '<button class="jspsych-btn" style="display:none">%choice%</button>',
          on_trial_start: function() { setTimeout(function() {setDisplay("jspsych-btn","")}, (Math.random() * 3000) + 3000)},
          is_html: true,
          timeline: [
              {choices: [arrivalprompt], stimulus: '<img src = "./img/data0_' + condition + '.jpg" width=800px>'},
              {choices: [arrivalprompt], stimulus: '<img src = "./img/data1_' + condition + '.jpg" width=800px>'},
              {choices: ['Click here to continue.'], stimulus: '<img src = "./img/data2_' + condition + '.jpg" width=800px>'},

         ]
      };

      var obs_block2 = {
          type: 'button-response',
          timing_post_trial: 0,
	      button_html: '<button class="jspsych-btn" style="display:none">%choice%</button>',
          on_trial_start: function() { setTimeout(function() {setDisplay("jspsych-btn","")}, (Math.random() * 800) + 800)},
          is_html: true,
          timeline: [
              {choices: [arrivalprompt], stimulus: '<img src = "./img/data2_' + condition + '.jpg" width=800px>'}, //this is skipped over
              {choices: [arrivalprompt], stimulus: '<img src = "./img/data3_' + condition + '.jpg" width=800px>'},
              {choices: [arrivalprompt], stimulus: '<img src = "./img/data4_' + condition + '.jpg" width=800px>'},
              {choices: [arrivalprompt], stimulus: '<img src = "./img/data5_' + condition + '.jpg" width=800px>'},
              {choices: ['Click here to continue.'], stimulus: '<img src = "./img/data6_' + condition + '.jpg" width=800px>'},
         ]
      };

      var obs_block3 = {
          type: 'button-response',
          timing_post_trial: 0,
        button_html: '<button class="jspsych-btn" style="display:none">%choice%</button>',
          on_trial_start: function() { setTimeout(function() {setDisplay("jspsych-btn","")}, (Math.random() * 800) + 800)},
          is_html: true,
          timeline: [
              {choices: [arrivalprompt], stimulus: '<img src = "./img/data6_' + condition + '.jpg" width=800px>'}, //this is skipped over
              {choices: [arrivalprompt], stimulus: '<img src = "./img/data7_' + condition + '.jpg" width=800px>'},
              {choices: [arrivalprompt], stimulus: '<img src = "./img/data8_' + condition + '.jpg" width=800px>'},
              {choices: [arrivalprompt], stimulus: '<img src = "./img/data9_' + condition + '.jpg" width=800px>'},
              {choices: [arrivalprompt], stimulus: '<img src = "./img/data10_' + condition + '.jpg" width=800px>'},
              {choices: [arrivalprompt], stimulus: '<img src = "./img/data11_' + condition + '.jpg" width=800px>'},
              {choices: ['Click here to continue.'], stimulus: '<img src = "./img/data12_' + condition + '.jpg" width=800px>'}
         ]
      };



	  /* define interim block */
      var interim_block = {
          type: 'button-response',
          timing_post_trial: 0,
		  button_html: '<button class="jspsych-btn" style="display:none">%choice%</button>',
          choices: ['Click here to continue'],
          on_trial_start: function() { setTimeout(function() {setDisplay("jspsych-btn","")}, 2000)},
		  is_html: true,
          timeline: [
              {stimulus: '<img src = "./img/interim1_' + condition + '.jpg" width=800px>'}
          ]
      };



	  /* define test block */
	  var test_block = {
	      type: 'button-response',
	      choices: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10'],
		  timing_post_trial: 500,
          button_html: '<button class="jspsych-btn" style="display:none">%choice%</button>',
		  randomize_order: true, // <- HM.
	      prompt: "<p class='center-content'><span id='zzzzz' style='display:none'>[1 = Definitely does not] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &nbsp; &nbsp; &nbsp; [10 = Definitely does]</span></p>",
		  is_html: true,
          on_trial_start: function() { setTimeout(function() {document.getElementById("zzzzz").style.display = ""; document.getElementById("qqqqq").style.display = ""; setDisplay("jspsych-btn","")}, 1000)},
		  timeline: [
              {stimulus: testString(testorder[0])},
			  {stimulus: testString(testorder[1])},
			  {stimulus: testString(testorder[2])},
              {stimulus: testString(testorder[3])},
			  {stimulus: testString(testorder[4])},
			  {stimulus: testString(testorder[5])},
              {stimulus: testString(testorder[6])}
		  ]
	  };



    /* observation + test */
    timeline.push(obs_block1);
    timeline.push(interim_block);
    timeline.push(test_block);

    /* observation + test */
    timeline.push(obs_block2);
    timeline.push(interim_block);
    timeline.push(test_block);

    /* observation + test */
    timeline.push(obs_block3);
    timeline.push(interim_block);
    timeline.push(test_block);


	  /* image list */
	  var images = [
		  './img/robot1.jpg',
		  './img/robot2.jpg',
		  './img/robot3_' + baserate + '.jpg',
		  './img/robot4_' + baserate + '.jpg',
	  	  './img/robot5_' + baserate + '.jpg',
          './img/robot6.jpg',
          './img/robot7.jpg',
          './img/robot8_' + condition + '.jpg',
          './img/robot9_' + condition + '.jpg',
          './img/robot10_' + baserate + '_' + condition + '.jpg',
          './img/instructionfail.jpg',
          './img/instructionsuccess_' + baserate + '_' + condition + '.jpg',
		  './img/data0_' + baserate + '_' + condition + '.jpg',
		  './img/data1_' + baserate + '_' + condition + '.jpg',
		  './img/data2_' + baserate + '_' + condition + '.jpg',
		  './img/data3_' + baserate + '_' + condition + '.jpg',
		  './img/data4_' + baserate + '_' + condition + '.jpg',
		  './img/data5_' + baserate + '_' + condition + '.jpg',
		  './img/data6_' + baserate + '_' + condition + '.jpg',
		  './img/data7_' + baserate + '_' + condition + '.jpg',
		  './img/data8_' + baserate + '_' + condition + '.jpg',
		  './img/data9_' + baserate + '_' + condition + '.jpg',
		  './img/interim1_' + condition + '.jpg',
		  './img/interim2_' + baserate + '_' + condition + '.jpg',
		  './img/interim3_' + baserate + '_' + condition + '.jpg',
		  './img/test1.jpg',
		  './img/test2.jpg',
		  './img/test3.jpg',
		  './img/test4.jpg',
		  './img/test5.jpg',
		  './img/test6.jpg',
		  './img/test7.jpg',
		  './img/test8.jpg'
	  ];







     // startExperiment();


  </script>
</html>
